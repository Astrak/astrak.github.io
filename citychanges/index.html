<!DOCTYPE html>
<html>
<head>
	<title>CASTRES</title>
	<link href='style.css' rel=stylesheet>
	<!-- hide adress bar and prevent scaling on ios -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui">
	<!-- enable fullscreen if added to home screen -->
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel='manifest' href='manifest.webapp'>
</head>
<body onload='main()' style='position:relative;background:#666'>
	<div id='canvas-container'></div>
	<!-- libs -->
	<script src='../libs/three.js'></script>
	<script src='../libs/CanvasRenderer.js'></script>
	<script src='../libs/Projector.js'></script>
	<script src='../libs/controls/OrbitControls.js'></script>
	<script src='../libs/controls/TrackballControls_modified.js'></script>
	<!--<script src='../../three/examples/js/controls/FlyControls.js'></script>-->
	<script src='http://cdnjs.cloudflare.com/ajax/libs/gsap/1.17.0/TweenMax.min.js'></script>
	<!-- resources -->
	<script src='scripts/resources.js'></script>
	<script src='scripts/trees.js'></script>
	<script src='scripts/cars.js'></script>
	<script src='scripts/UI3.js'></script>
	<script>

		function main(){

			'use strict';

			var canvasContainer=document.getElementById('canvas-container');

			//for experiment
			canvasContainer.style.cssText=''+
				'width:700px;height:300px;'+
				'margin-left:'+(innerWidth-700)/2+'px;'+
				'margin-top:'+(innerHeight-300)/2+'px;'+
				'border-radius:10px;'+
				'box-shadow:0px 10px 10px #444';

		    var steps=[
		            {
		                from:'2011',
		                to:'JUN 2014',
		                title:"Vente du terrain",
		                description:"Déménagement de l'hôpital au Causse, vente du terrain puis désamiantage"
		            },
		            {
		                from:'JUN 2014',
		                to:'JAN 2015',
		                title:'Déconstruction et terrassement',
		                description:'Déconstruction, terrassement et reliage de la voirie et des réseaux divers'
		            },
		            {
		                from:'JAN 2015',
		                to:'JAN 2016',
		                title:'Gros oeuvre',
		                description:'Construction du parking, des résidences et commerces et aménagements du bâtiment Gambetta'
		            }
		        ];

			window.landscape = new Landscape(resources,{

				//fTLL : allows textures above this number to be considered unnecessary if connexion is low
				firstTexturesLoadLimit:7,//included
				
				//envmeshes : will merge those meshes for a lower view option (single draw call for them)
				//  if ftll : the merged mesh will be visible first and the switch (will) occurs on texturescomplete
				//	else : the merged mesh is available to speed up rendering
				envMeshes:['gardens','routes','trottoirs','gambettacity'],//name or meshRef of env meshes to remove/ merge at untextured level.
				
				//will create sky with this texture
				skyTexture:9,

				container:canvasContainer,

				//steps:steps,

				//views:['massPlan','compass'],//+default aerial view

				//informations:['infos','PLU'],

				cars:cars,

				trees:trees,

				//developper:true >> to enable car paths, lights, trees and PLU modifications ?!
			});

		    //test to output an image
		    //renderer.setPixelRatio(3);
		    //renderer.setSize(3*innerWidth,3*innerHeight);
		    //renderer.render(scene,camera);

		    //var img=renderer.domElement.toDataURL();
		    //var i=document.createElement('img');
		    //i.src=img;
		    //var a =document.createElement('a');
		    //a.href=img;
		    //a.download='rendered.png';
		    //a.innerHTML='click HERE !!!'
		    //a.style.cssText='position:absolute;top:10px;left:100px;'
		    //document.body.appendChild(a);
		}
	</script>
</body>
</html>